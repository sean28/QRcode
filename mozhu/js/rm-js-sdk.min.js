function RuanmeiJsFunctions(){function navTo(a,b){var c,d;mp?getbd()[a]({url:b.url&&0===b.url.indexOf("/pages/")?b.url:"/pages/webview/webview?url="+encodeURIComponent(getAbsolutePath(b.url))}):that.isLegalEnv()?(c=b,Object.assign(c,{url:getTargetUrl(b),openExternal:!!b.openExternal,skipLeaveTip:!!b.skipLeaveTip}),callNative(a,c,null)):(d=document.createElement("a"),d.href=b.url,"navigateTo"==a&&(d.target="_blank"),d.click())}function notifyNativeReady(){var c,d,e,a=document.querySelectorAll("meta[name]"),b=[];for(c=0;c<a.length;c++)d=a[c],b.push({name:d.getAttribute("name"),value:d.getAttribute("content")});e={name:"_sdk_init_ready",meta:b},that.sendMessage(e)}function addRNCallback(a,b){var c=++rnLastCallbackId;return rnCallbacks[""+c]={callback:a,context:b},c}function registerJsFuns(a,b){errorMsg+="-- register Js Funs.\n",a[b]("onPageVisibleChanged",function(a){notifyVisibleChanged(a)}),a[b]("onAppThemeChanged",function(a){resetTheme(genObj(a))}),a[b]("onOptionMenuClicked",function(a){_optionMenuCB&&_optionMenuCB(genObj(a))}),a[b]("onReceiveMessage",function(a,b){var e,c=genObj(a),d=c.name;"undefined"!=typeof _listeners[d]&&(e=null,b&&(e=function(a){b("object"==typeof a?JSON.stringify(a):a+"")}),_listeners[d](c.data,e))})}function doneBridge(a){function f(){mp||"ithome.com"===urlInfo.topDomain||"localhost"===urlInfo.topDomain?(loadJs("https://dat.ruanmei.com/lib/showToast.js"),window._parseJSSDKKey=function(a){var e,f,g;secret=window.atob(a),e=parseUrl(this.window.location.href).params._rmsdktoken,isEmpty(e)||(f=JSON.parse(that.decryptSync({text:e}).data),g=f.__hash,mpappname=f.__appName||"unknown",delete f.__hash,hash={success:!0,userHash:g},userInfo={success:!0,userInfo:f}),b=!0,c=!0,d=!0,h()},loadJs("https://dat.ruanmei.com/lib/rm-js-sdk-key.js")):(b=!0,c=!0,d=!0,h())}function g(a){console.warn("JS-SDK",a)}function h(){var a,e,f,g;if(!isReady&&b&&c&&d){try{a="*{-webkit-tap-highlight-color: rgba(0, 0, 0, 0) !important;}.disable-user-select-ruanmei-sdk * {-webkit-touch-callout:none;-webkit-user-select:none;user-select:none;}pre,input,textarea{-webkit-touch-callout:default;-webkit-user-select:text;user-select:text;}",e=document.head||document.getElementsByTagName("head")[0],f=document.createElement("style"),sysInfo&&sysInfo.systemInfo&&!isEmpty(sysInfo.systemInfo.userCustomFont)&&(g="","ithome"===appStr&&isAndroid&&8.2>appver&&(g="/"),a+="@font-face{font-family: myFirstFont; src: url('"+g+sysInfo.systemInfo.userCustomFont+"')} body *{font-family:myFirstFont, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Ubuntu, Helvetica Neue, Arial, PingFang SC, Microsoft YaHei, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol;}"),f.type="text/css",f.styleSheet?f.styleSheet.cssText=a:f.appendChild(document.createTextNode(a)),e.appendChild(f)}catch(h){}isReady=!0,readyCallbacks.forEach(function(a){a()}),readyCallbacks=[],window._selfSendJssdkReadyMessage||notifyNativeReady(),enableSwipeRefresh()}}if(null==a)return errorMsg+="-- init bridge error(null).\n",f(),void 0;bridgeInternal=a,callNative=function(a,b,c){var d,e;if("showModal"===a&&b&&!b.textAlign&&(b.textAlign=b.content&&b.content.length>=12?"left":"center"),that.isLegalEnv())if(mp){if("getUserHash"===a&&hash.success)return c(hash);if("encrypt"===a)return c(that.encryptSync(b));if("decrypt"===a)return c(that.decryptSync(b));if("toast"===a)return window._showToast&&window._showToast(b.data,b.duration||5e3);c&&c({success:!1,message:"小程序不支持此操作，请使用IT之家App"})}else isUWP||isReactNative&&-1!==rnApis.indexOf(allApiNames.indexOf(a))||isCommonChannel||inIframe?((null==b||"undefined"==typeof b)&&(b={}),d=b,isCommonChannel||inIframe?d={name:a,data:b,isInternalApi:!0}:isUWP||"object"!=typeof b||Array.isArray(b)?d={name:"sdk-api-"+a,data:b}:d.name="sdk-api-"+a,that.sendMessage(d,c)):(isAndroid||isIOS||isMac&&!isElectron)&&(e=isAndroid?"call":"callHandler",null!==c?bridgeInternal[e](a,b,function(a){c(genObj(a))}):bridgeInternal[e](a,b));else c&&c({success:!1,message:"运行环境非法(005)"})};var b=!1,c=!1,d=!1;if(that.isLegalEnv()&&!mp){if(!useNewInit){try{callNative("getUserInfo",null,function(a){userInfo=a,c=!0,h()})}catch(e){c=!0,h(),g("User check failed!")}try{callNative("getUserHash",null,function(a){hash=a,d=!0,h()})}catch(e){d=!0,h(),g("Userhash check failed!")}}try{callNative("getSystemInfo",{needAuth:!0},function(a){"undefined"!=typeof a.systemInfo&&(a.systemInfo.isWxmp=!1),sysInfo={success:a.success,systemInfo:a.systemInfo},intent=a.intent?a.intent:null,isEmpty(a.extra)||(secret=a.extra),b=!0,(a._userInfo||inIframe)&&(userInfo=a._userInfo||{},c=!0),(a._userHash||inIframe)&&(hash=a._userHash||{},d=!0),h()})}catch(e){b=!0,h(),g("System check failed!")}}else f()}function enableSwipeRefresh(a){var c,d,b=document.getElementsByTagName("meta")["rm-pull-down-refresh"];b&&(c=b.getAttribute("content"),d="false"!==c,"undefined"!=typeof a&&(d=d&&a>0),that.sendMessage({name:"setSwipeRefreshEnable",enable:d,offsetTop:Number.isNaN(Number(c))?0:parseInt(c)}))}function setupWebViewJavascriptBridge(a){if(window.WebViewJavascriptBridge)return a(WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(a);window.WVJBCallbacks=[a];var b=document.createElement("iframe");b.style.display="none",("lapin"!==appStr||0!==window.location.href.indexOf("file://"))&&(b.src="https://__bridge_loaded__"),document.documentElement.appendChild(b),setTimeout(function(){document.documentElement.removeChild(b)},0)}function notifyVisibleChanged(a){_onPageVisibleChanged&&_onPageVisibleChanged(genObj(a)),watchIframes.forEach(function(b){var c=genObj(a)||{};c.callbackId=-1,c.jssdk=!0,b.contentWindow.postMessage(c,"*")})}function resetTheme(a){a.isDark=a.isNight||a.isDark,null!==_onAppThemeChanged?_onAppThemeChanged(a):(toggleCLass("html",a.isDark,"night"),toggleCLass("body",a.isDark,"night")),watchIframes.forEach(function(b){var c=a||{};c.callbackId=-2,c.jssdk=!0,b.contentWindow.postMessage(c,"*")})}function processRnOrElCallback(a){var d,b=a,c=b.callbackId;delete b.callbackId,-1==c?notifyVisibleChanged(b):-2==c?resetTheme(b):-3==c?_listeners[b.name]&&_listeners[b.name](b.data,function(a){that.sendMessage({name:"__onReceiveMessageCallback",messageId:b._messageId,data:a})}):-4==c?_optionMenuCB&&_optionMenuCB(b):c>-1&&(d=rnCallbacks[""+c],d&&d.callback&&d.callback.call(d.context,b),delete rnCallbacks[""+c])}function toggleCLass(a,b,c){try{document.getElementsByTagName(a)[0].classList[b?"add":"remove"](c)}catch(d){}}function getTargetUrl(a){var c,d,e,b={};return Object.keys(a).forEach(function(c){b[c.toLowerCase().replace(/-/g,"")]=a[c]}),c=b.url,d=relation[appStr].s+getPlat().toLowerCase().replace("/",""),e=relation[appStr].f,isEmpty(b[d])?isEmpty(b[e])||(c=b[e]):c=b[d],getAbsolutePath(c)}function isEmpty(a){return null==a||"undefined"==typeof a||0==a.length}function convert2QueryString(a){var c,d,e,f,b="";if("string"==typeof a)for(b=a;b.length>1&&(0==b.indexOf("&")||0==b.indexOf("?"));)b=b.substring(1);else if("object"==typeof a){c=a;for(d in c)e=c[d],f=encodeURIComponent(d)+"="+encodeURIComponent(e),b+=(0===b.length?"":"&")+f}return b}function getAbsolutePath(a){var b=document.createElement("a");return b.href=a,b.href}function parseUrl(a){var b,c,d,e,f,g,h,i,j,k,l;(isEmpty(a)||"about:blank"===a||0===a.indexOf("data:"))&&(a="about://blank"),b=a.split("://"),c=b[0],d=b[1],-1!=d.indexOf("/")&&(d=d.split("/")[0]),-1!==d.indexOf("?")&&(d=d.substring(0,d.indexOf("?"))),-1!==d.indexOf("#")&&(d=d.substring(0,d.indexOf("#"))),e={},f="",g="",h=a.substring(a.indexOf("?")+1,a.length).split("&");for(i in h)j=h[i],j.indexOf("=")>0&&(f=j.substring(0,j.indexOf("=")),g=j.substring(j.indexOf("=")+1),-1!==g.indexOf("#")&&(g=g.substring(0,g.indexOf("#"))),e[f]=decodeURIComponent(g));for(-1!==d.indexOf(":")&&(k=d.substring(d.indexOf(":")+1),d=d.substring(0,d.indexOf(":"))),l=d;l.indexOf(".")!==l.lastIndexOf(".");)l=l.substring(l.indexOf(".")+1);return{scheme:c.toLowerCase(),host:d.toLowerCase(),topDomain:l,port:k,params:e}}function _ajax(a,b){var c,d,e;a=a||{},a.method=(a.method||"POST").toUpperCase(),a.url=a.url||"",a.async=a.async||!0,a.data=a.data||null,a.callback=b||function(){},c=null,c=XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),c.open(a.method,a.url,a.async);for(d in a.header)e=a.header[d],c.setRequestHeader(d,e);c.send("POST"===a.method.toUpperCase()?a.data:null),c.onreadystatechange=function(){if(4==c.readyState){var b=c.status;a.callback({statusCode:b,data:b>=200&&300>b?genObj(c.responseText):null})}}}function getbd(){var b,a=null;return mp&&(b=mp.bn.split("."),b.forEach(function(b,c){0===c?(a=window[b],a||console.error("请在页面中引入小程序平台JS-SDK，并在真机环境中调试。")):a=a[b]})),a}function genObj(a){var b=a;try{b="object"==typeof a?a:JSON.parse(a)}catch(c){b=a}return b}function is(a){return relation[appStr].s===a||relation[appStr].f===a}function getPlat(){var a="unknown";return isHM?a="HarmonyOS":isAndroid?a="Android":isIOS?a="iOS":isUWP?a="UWP":isElectron?(a="Electron",-1!==UA.indexOf("macOS")?a+="/macOS":-1!==UA.indexOf("win32")?a+="/win32":-1!==UA.indexOf("linux")?a+="/linux":-1!==UA.indexOf("monitor-i-o-s")?a="iOS":-1!==UA.indexOf("monitor-a-n-d")&&(a="Android")):isMac?a="macOS":isWin&&(a="windows"),a}function getArgs(a){var d,b=null,c=null;for(d=0;d<a.length;d++)"function"==typeof a[d]&&null==b?b=a[d]:"undefined"!=typeof a[d]&&null==c&&(c=a[d]);return[c,b]}function loadJs(a){var b=document.createElement("script"),c=document.getElementsByTagName("head")[0];b.type="text/javascript",b.async=!0,b.charset="utf-8",b.src=a,c.appendChild(b)}function getFrameByEvent(a){return[].slice.call(document.getElementsByTagName("iframe")).filter(function(b){return b.contentWindow===a.source})[0]}var i,ele,uastrs,noexist,bridge,urlInfo=parseUrl(window.location.href),that=this,UA=urlInfo.params._useragent||(window._customUserAgent?window._customUserAgent.value:void 0)||navigator.userAgent,proxyName=urlInfo.params._jsproxy,isAndroid=/(Android)/i.test(UA),isIOS=/(iPhone|iPad|iPod|iOS)/i.test(UA),isUWP=/(uwpclient)/i.test(UA),isMac=/(Macintosh)/i.test(UA),isCatalyst=/(\/catalyst\/)/i.test(UA),isWin=/(Windows NT)/i.test(UA),isNative=/(\/native\/)/i.test(UA),useNewInit=/(\/rmsdklevel2\/)/i.test(UA),tRes=(UA+" ").match(/ (ithome|lapin|ggUnionClient|taofuli|mytime|zuihuimai|etf365|rmyaozhi)\S*\/(\d+\.\d+)\s+/)||["/-1","unknown","-1"],pIdx=tRes[2].indexOf("."),appStr=tRes[1],appver=parseFloat(-1===pIdx?tRes[2]:tRes[2].substring(0,pIdx+1)+tRes[2].substring(pIdx+1).replace(/\./g,"")),relation={ithome:{s:"it",f:"ithome",m:6.38,t:"n"},lapin:{s:"lp",f:"lapin",m:3.63,t:"n"},ggUnionClient:{s:"ad",f:"adunion",m:1,t:"n"},taofuli:{s:"tao",f:"taofuli",m:1,t:"r"},mytime:{s:"mt",f:"mytime",m:.58,t:"n|r|e"},zuihuimai:{s:"zhm",f:"zuihuimai",m:1,t:"n"},etf365:{s:"etf",f:"etf365",m:.1,t:"n"},rmyaozhi:{s:"ryz",f:"rmyaozhi",m:.1,t:"n"},unknown:{s:"unknown",f:"unknown",m:999,t:"n"}},isWkwebview=-1!==UA.indexOf("wkwebview"),isReactNative=(isAndroid||isIOS)&&(/(\/reactnative\/)/i.test(tRes[0])||-1!==relation[appStr].t.indexOf("r")&&!/(\/native\/)/i.test(tRes[0])&&!/(\/flutter\/)/i.test(tRes[0])),isElectron=-1!==UA.indexOf("Electron"),isHM=-1!==UA.indexOf("/harmonyos/"),isNewHM=-1!==UA.indexOf("/hosnext/"),isWebview2=-1!==UA.indexOf("/webview2/"),iswkwebview2=-1!==UA.indexOf("/wkwbview2/"),isCommonChannel=isHM||isElectron||isWebview2||iswkwebview2||isWin&&isNative,mpappname="unknown",sdkver=3.56,allApiNames=["canIUse","closeWindow","getSettings","getUserInfo","getUserHash","getSystemInfo","setClipboardData","getClipboardData","navigateTo","redirectTo","toast","login","hideMenus","scanCode","showMenus","share","shareConfig","showModal","encrypt","decrypt","downloadFile","saveImageToPhotosAlbum","onEvent","previewImage","hideToast","showLoading","hideLoading","getPushTags","request","addOrRemovePushTags","showActionSheet","requestPayment","onPageVisibleChanged","showUpgradeTip","openKeyboard","canOpenURL","shareFile","getInstalledApps","copyFile","getLocation","getDeviceInfo","requestReviewApp","addCalendarEvent","getShareAuthInfo","vibrate","setStorage","getStorage","removeStorage","getBondedDevices","requestBindAccount"],wxCanUse=[0,15,13,1,8,9,23,19,18,11,3,4,5,28,10],normalApis=[2,4,6,7,10,12,14,16,17,18,19,20,21,22,24,25,26,27,29,30,31,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49],rnApis=[3,4,12,14,16,11,1,8,9,2,13,15,10,16,23,25,26,32,30],isReady=!1,readyCallbacks=[],userInfo={},hash={},sysInfo={},intent=null,bridgeInternal=null,errorMsg="SDK initialization not finished, please wait.\n ",callNative=function(a,b,c){if(null!=c){var d=errorMsg;isAndroid&&!window._dsbridge||isIOS&&!window.WebViewJavascriptBridge?d+="-- Bridge status: not exist.\n ":(isAndroid&&window._dsbridge||isIOS&&window.WebViewJavascriptBridge)&&(d+="-- Bridge status: has injected. \n"),c({success:!1,message:d})}},_onPageVisibleChanged=null,_onAppThemeChanged=null,_optionMenuCB=null,_listeners={},secret="",encryptStr=function(m,k){return eval(secret),{success:!0,data:enc(m,k).toString()}},decryptStr=function(m,k){return eval(secret),{success:!0,data:dec(m,k).toString()}},textSelectable=!1,rnCallbacks={},rnLastCallbackId=0,callIframeCallbacks={},callIframeCallbackId=0,mps=[{n:"alimp",ua:"AlipayClient",bns:"my",bn:"my"},{n:"qqmp",ua:"miniProgram|QMA",bns:"qq",bn:"qq.miniProgram"},{n:"wxmp",ua:"miniProgram",bns:"wx",bn:"wx.miniProgram"}],mp=null,proxy={},inIframe=window!==parent,watchIframes=[];for(i=0;i<mps.length;i++)if(ele=mps[i],uastrs=ele.ua.split("|"),noexist=uastrs.filter(function(a){return-1===UA.toLowerCase().indexOf(a.toLowerCase())}),0===noexist.length){mp=ele;break}this.getUA=function(){return UA},this.ready=function(a){isReady?a():readyCallbacks.push(a)},normalApis.forEach(function(a){var b=allApiNames[a];that[b]=function(){var a=getArgs(arguments);"showActionSheet"===b&&(a[0].menuList?(a[0].itemList=[],a[0].menuList.forEach(function(b){a[0].itemList.push(b.name)})):a[0].itemList&&(a[0].menuList=[],a[0].itemList.forEach(function(b){a[0].menuList.push({name:b})}))),callNative(b,a[0],a[1])}}),this.registerProxy=function(a,b){1===arguments.length?proxy["_common_"]=arguments[0]:proxy[a]=b},this.notifyNativeReady=function(){window._selfSendJssdkReadyMessage?notifyNativeReady():console.error("Please define global variable _selfSendJssdkReadyMessage and set it's value to true.")},this.onPullDownRefresh=function(a){this.onReceiveMessage("onRefreshingStart",a)},this.startPullDownRefresh=function(){this.sendMessage({name:"setRefreshing",refreshing:!0})},this.stopPullDownRefresh=function(){this.sendMessage({name:"setRefreshing",refreshing:!1})},this.setSwipeRefreshEnable=function(a){enableSwipeRefresh(a?1:-1)},this.onBeforeClose=function(a){window._onBeforeCloseWindow=a},this.openKeyboard=function(a){callNative("openKeyboard",null,null),a&&setTimeout(function(){var b=document.getElementById(a);b&&b.focus()},300)},this.bindNavigation=function(cb){that.isLegalEnv()&&(window.__rmNavLitener||(window.__rmNavLitener=function(e){for(var redirect,external,sName,fName,url,params,hasAttrOrClass=function(a,b){return a.hasAttribute(b)||a.classList&&a.classList.contains(b)},target=e.target,fireEvent=!1;!fireEvent&&target&&target!==e.currentTarget;){if(hasAttrOrClass(target,"rm-nav")){fireEvent=!0;break}target=target.parentElement||target.parentNode}fireEvent&&(e.preventDefault(),redirect=hasAttrOrClass(target,"redirect"),external=hasAttrOrClass(target,"external"),sName="href-"+relation[appStr].s+"-"+getPlat().toLowerCase().replace("/","-"),fName="href-"+relation[appStr].f,url=target.getAttribute(sName)||target.getAttribute(fName)||target.getAttribute("href"),isEmpty(url)||(0==url.indexOf("javascript:")?eval(url.substring(11)):(params={url:url},external&&Object.assign(params,{openExternal:external}),that[redirect?"redirectTo":"navigateTo"](params))))}),document.removeEventListener("click",window.__rmNavLitener,!1),document.addEventListener("click",window.__rmNavLitener,!1)),cb&&cb({success:that.isLegalEnv()})},this.sendMessage=function(a){var d,e,f,b="function"==typeof arguments[1]?arguments[1]:null,c=b?arguments[2]:arguments[1];return"object"==typeof a&&(a._location_href=window.location.href,"object"==typeof c&&c&&c.contentWindow)?(d=++callIframeCallbackId,b&&(callIframeCallbacks[""+d]=b),c.contentWindow.postMessage(Object.assign({callbackId:-3,_messageId:d,jssdk:!0,data:a},a),"*"),void 0):(isReactNative&&"native"!==a.proxyEnv||isUWP||isCommonChannel||inIframe?(!isCommonChannel&&!inIframe||a.isInternalApi||(a={name:"sendMessage",data:a}),a.callbackId=null!=b?addRNCallback(b,this):-1,a._jsproxy=proxyName,e=isCommonChannel||inIframe?a:JSON.stringify({name:"SDK-sendMessage",message:JSON.stringify(a)}),inIframe?(e._iframemsg=!0,window.parent.postMessage(e,"*")):(f=isReactNative?"ReactNativeWebView":"UWPOrElBridge",window[f].postMessage(e))):callNative("sendMessage",a,b),void 0)},this.onReceiveMessage=function(a,b){_listeners[a]=b},this.config=function(a){var b=a.pageAttr;"undefined"!=typeof b&&(textSelectable=!!b.textSelectable,that.setTextSelectEnable(textSelectable)),callNative("config",a,null)},this.isLegalEnv=function(){return is("it")&&isMac&&appver>=1.35||appver>=relation[appStr].m||!!mp},this.setTextSelectEnable=function(a){textSelectable=a,toggleCLass("body",!a,"disable-user-select-ruanmei-sdk")},this.getEnv=function(){var b,a=relation[appStr].f;return mp&&(a=mp.n),b="unknown",that.isLegalEnv()&&(b="native"),isReactNative&&(b="react native"),isElectron&&(b="electron"),{isLegal:that.isLegalEnv(),app:mp?mpappname:a,platform:getPlat(),appver:mp?6.6:appver,sdkver:sdkver,isWxmp:mp&&"wxmp"===mp.n,isHM:isHM,isNewHM:isNewHM,mpname:mp&&mp.n,framework:b}},this.getSystemInfo=function(){var b,a=getArgs(arguments);callback=a[1],mp?(b={},b.isWxmp=mp&&"wxmp"===mp.n,b.platform=getPlat(),callback({success:!0,systemInfo:b})):callNative("getSystemInfo",a[0],callback)},this.getSystemInfoSync=function(){if(mp){var a={};return a.isWxmp=mp&&"wxmp"===mp.n,a.mpname=mp&&mp.n,a.platform=getPlat(),{success:!0,systemInfo:a}}return sysInfo},this.getIntent=function(){return intent},this.createOptionMenus=function(a,b){_optionMenuCB=b,callNative("createOptionMenus",a,null)},this.login=function(){var a=getArgs(arguments);return mp&&userInfo.success?a[1](userInfo):(callNative("login",a[0],function(b){userInfo=b,callNative("getUserHash",null,function(c){hash=c,a[1](b)})}),void 0)},this.getUserInfo=function(){var a=getArgs(arguments);return mp&&userInfo.success?a[1](userInfo):(callNative("getUserInfo",a[0],function(b){userInfo=b,a[1](b)}),void 0)},this.getUserInfoSync=function(){return userInfo},this.getUserHashSync=function(){return hash},this.share=function(a,b){mp?getbd().navigateTo({url:"/pages/tool/share?"+convert2QueryString({title:a.title,image:a.imgUrl,url:a.url})}):callNative("share",a,b)},this.scanCode=function(a,b){mp?window[mp.bns].scanQRCode({needResult:!!a.needResult,success:function(a){b({success:!0,data:a.resultStr})}}):callNative("scanCode",a,b)},this.canIUse=function(a,b){if(mp){var c=[];a.forEach(function(a){-1==wxCanUse.indexOf(allApiNames.indexOf(a))&&c.push(a)}),b({success:0==c.length,cannot:c})}else that.isLegalEnv()?callNative("canIUse",a,function(a){var c=a;isReactNative&&(c.cannot=c.cannot||[],c.cannot=c.cannot.filter(function(a){return-1==rnApis.indexOf(allApiNames.indexOf(a))}),c.success=0==c.cannot.length),b(c)}):b({success:!1,cannot:a})},this.closeWindow=function(){mp?getbd().navigateBack({delta:1}):callNative("closeWindow",null,null)},this.onPageVisibleChanged=function(a){_onPageVisibleChanged=a},this.onAppThemeChanged=function(a){_onAppThemeChanged=a},this.request=function(a,b){var f,g,h,i,j,c={},d="GET",e=getAbsolutePath(a.url);"undefined"!=typeof a.method&&(d=a.method.toUpperCase()),f=a.header,g="content-type",h="application/x-www-form-urlencoded","undefined"==typeof f&&(f={}),"undefined"==typeof f[g]&&(f[g]=h),i=null,"GET"==d||"HEAD"==d?(j=convert2QueryString(a.data),j.length>0&&(e+=(-1!==e.indexOf("?")?"&":"?")+j)):(i=a.data,"application/json"===f[g]?i=JSON.stringify(a.data):f[g]===h&&(i=convert2QueryString(a.data))),c.method=d,c.url=e,c.header=f,c.data=i,!this.isLegalEnv()||mp?_ajax(c,b):callNative("HEAD"==d?"requestHeader":"request",c,b)},this.navigateTo=function(a){navTo("navigateTo",a)},this.redirectTo=function(a){navTo("redirectTo",a)},this.previewImage=function(a){a.url=getAbsolutePath(a.url);var b=[];(a.imgUrls||[]).forEach(function(a){b.push(getAbsolutePath(a))}),a.anchor&&(a.anchor=JSON.parse(JSON.stringify(a.anchor))),a.imgUrls=b,mp?window[mp.bns].previewImage({current:a.url,urls:a.imgUrls}):callNative("previewImage",a,null)},this.encryptSync=function(a){return encryptStr(a.text,a.key)},this.decryptSync=function(a){return decryptStr(a.text,a.key)},isReactNative||isUWP?document.addEventListener("rnJsSdkCallback",function(a){processRnOrElCallback(a.data)},!1):isWebview2?window.chrome.webview.addEventListener("message",function(a){processRnOrElCallback(a.data)}):isCommonChannel&&(window.__electronOnMessage=processRnOrElCallback),!that.isLegalEnv()||mp||inIframe?doneBridge({}):isUWP||isCommonChannel?(window.UWPOrElBridge={postMessage:function(a){var b;isUWP?window.external.notify(a):iswkwebview2?window.webkit.messageHandlers.rmjssdk.postMessage(JSON.stringify(a)):isWebview2?window.chrome.webview.postMessage(a):isHM?(b=window._rmHarmonyBridge,b&&b.call&&b.call(JSON.stringify(a))):(b=window.__electronPostMessage,b&&b("sdkMsg",a))}},doneBridge({})):isAndroid?(bridge={"default":this,call:function(a,b,c){var e,f,d="";return"function"==typeof b&&(c=b,b={}),e={data:void 0===b?null:b},"function"==typeof c&&(f="dscb"+window.dscb++,window[f]=c,e["_dscbstub"]=f),e=JSON.stringify(e),window._dsbridge?d=_dsbridge.call(a,e):(window._dswk||-1!==UA.indexOf("_dsbridge"))&&(d=prompt("_dsbridge="+a,e)),JSON.parse(d||"{}").data},register:function(a,b,c){var d=c?window._dsaf:window._dsf;window._dsInit||(window._dsInit=!0,setTimeout(function(){bridge.call("_dsb.dsinit")},0)),"object"==typeof b?d._obs[a]=b:d[a]=b},registerAsyn:function(a,b){this.register(a,b,!0)},hasNativeMethod:function(a,b){return this.call("_dsb.hasNativeMethod",{name:a,type:b||"all"})},disableJavascriptDialogBlock:function(a){this.call("_dsb.disableJavascriptDialogBlock",{disable:a!==!1})}},!function(){var a,b;if(!window._dsf){a={_dsf:{_obs:{}},_dsaf:{_obs:{}},dscb:0,dsBridge:bridge,close:function(){bridge.call("_dsb.closePage")},_handleMessageFromNative:function(a){var h,i,j,k,l,m,b=JSON.parse(a.data),c={id:a.callbackId,complete:!0},d=this._dsf[a.method],e=this._dsaf[a.method],f=function(a,d){c.data=a.apply(d,b),bridge.call("_dsb.returnValue",c)},g=function(a,d){b.push(function(a,b){c.data=a,c.complete=b!==!1,bridge.call("_dsb.returnValue",c)}),a.apply(d,b)};if(d)f(d,this._dsf);else if(e)g(e,this._dsaf);else{if(h=a.method.split("."),h.length<2)return;if(i=h.pop(),j=h.join("."),k=this._dsf._obs,l=k[j]||{},m=l[i],m&&"function"==typeof m)return f(m,l),void 0;if(k=this._dsaf._obs,l=k[j]||{},m=l[i],m&&"function"==typeof m)return g(m,l),void 0}}};for(b in a)window[b]=a[b];bridge.register("_hasJavascriptMethod",function(a){var d,e,c=a.split(".");return c.length<2?!(!_dsf[c]&&!_dsaf[c]):(a=c.pop(),d=c.join("."),e=_dsf._obs[d]||_dsaf._obs[d],e&&!!e[a])}),registerJsFuns(bridge,"registerAsyn")}}(),doneBridge(bridge)):(isIOS||isMac&&!isElectron)&&(errorMsg="SDK initialization Begin.\n",isReactNative&&!window.ReactNativeWebView&&(isWkwebview?window.ReactNativeWebView={postMessage:function(a){window.webkit.messageHandlers.ReactNativeWebView.postMessage(String(a))}}:function(){function c(){a.length&&!b&&(b=!0,document.location="react-js-navigation://ReactNativeWebView?"+encodeURIComponent(a.shift()))}var a=[],b=!1;window.ReactNativeWebView={postMessage:function(b){a.push(String(b)),c()},messageReceived:function(){b=!1,c()}}}()),setupWebViewJavascriptBridge(function(a){errorMsg+="-- js injected.\n",registerJsFuns(a,"registerHandler"),doneBridge(a)})),window.addEventListener("message",function(a){var d,e,f,g,h,i,b=a.data,c=b&&b.name&&b._iframemsg;inIframe&&!c?a.data&&a.data.jssdk&&a.data.callbackId&&processRnOrElCallback.call(that,a.data):"sendMessage"===b.name&&b._iframemsg&&b.data&&"__onReceiveMessageCallback"===b.data.name?b.data.messageId&&callIframeCallbacks[""+b.data.messageId]&&callIframeCallbacks[""+b.data.messageId](b.data.data):b.name&&that[b.name]&&b._iframemsg&&(d=parseUrl(a.origin),e=d.topDomain===urlInfo.topDomain,f=b._jsproxy||"_common_",g=getFrameByEvent(a),e||(e=proxy[f]&&proxy[f]["onInvoke"]&&proxy[f]["onInvoke"](a.origin,b.name,g)),e&&(h=b.callbackId,i=proxy[f]&&proxy[f][b.name]||that[b.name],h>-1?that.ready.call(that,function(){i.call(that,b.data,function(a){if(g){var b=a;b.callbackId=h,b.jssdk=!0,g.contentWindow.postMessage(b,"*")}},g)}):that.ready(function(){i.call(that,b.data,void 0,g)}),-1===watchIframes.indexOf(g)&&watchIframes.push(g)))},!1)}var rm=new RuanmeiJsFunctions;